Program.Sub.ScreenSU.Start
Gui.FrmPO..Create
Gui.FrmPO..Size(15360,10695)
Gui.FrmPO..MinX(15360)
Gui.FrmPO..MinY(10695)
Gui.FrmPO..Position(0,0)
Gui.FrmPO..BackColor(-2147483633)
Gui.FrmPO..MousePointer(0)
Gui.FrmPO..Event(UnLoad,FrmPO_UnLoad)
Gui.FrmPO..Caption("Purchase Order Review with PO Confirmation")
Gui.FrmPO.tabPODash.Create(Tab)
Gui.FrmPO.tabPODash.Size(15120,9015)
Gui.FrmPO.tabPODash.Position(15,1125)
Gui.FrmPO.tabPODash.Tabs(5)
Gui.FrmPO.tabPODash.SetTab(0)
Gui.FrmPO.tabPODash.Caption("All POs")
Gui.FrmPO.tabPODash.SetTab(1)
Gui.FrmPO.tabPODash.Caption("Expected Today")
Gui.FrmPO.tabPODash.SetTab(2)
Gui.FrmPO.tabPODash.Caption("Past Due")
Gui.FrmPO.tabPODash.SetTab(3)
Gui.FrmPO.tabPODash.Caption("Outside Service Request")
Gui.FrmPO.tabPODash.SetTab(4)
Gui.FrmPO.tabPODash.Caption("Requisitions")
Gui.FrmPO.GsGCAllPOs.Create(GsGridControl)
Gui.FrmPO.GsGCAllPOs.Size(15000,8655)
Gui.FrmPO.GsGCAllPOs.Position(0,0)
Gui.FrmPO.GsGCAllPOs.Parent("tabPODash",0)
'GB    GCG_5222	
'Gui.FrmPO.GsGCAllPOs.Event(RowCellClick,GsGCAllPOs_RowCellClick)
Gui.FrmPO.GsGCAllPOs.Event(CellValueChanged,GsGCAllPOs_CellValueChanged)
Gui.FrmPO.GsGCExpToday.Create(GsGridControl)
Gui.FrmPO.GsGCExpToday.Size(15000,8655)
Gui.FrmPO.GsGCExpToday.Position(0,0)
Gui.FrmPO.GsGCExpToday.Parent("tabPODash",1)
'GB    GCG_5222	
'Gui.FrmPO.GsGCExpToday.Event(RowCellClick,GsGCExpToday_RowCellClick)
Gui.FrmPO.GsGCExpToday.Event(CellValueChanged,GsGCExpToday_CellValueChanged)
Gui.FrmPO.GsGCPastDue.Create(GsGridControl)
Gui.FrmPO.GsGCPastDue.Size(15000,8655)
Gui.FrmPO.GsGCPastDue.Position(0,0)
Gui.FrmPO.GsGCPastDue.Parent("tabPODash",2)
'GB    GCG_5222	
'Gui.FrmPO.GsGCPastDue.Event(RowCellClick,GsGCPastDue_RowCellClick)
Gui.FrmPO.GsGCPastDue.Event(CellValueChanged,GsGCPastDue_CellValueChanged)
Gui.FrmPO.GsGCOSV.Create(GsGridControl)
Gui.FrmPO.GsGCOSV.Size(15000,8655)
Gui.FrmPO.GsGCOSV.Position(0,0)
Gui.FrmPO.GsGCOSV.Parent("tabPODash",3)
'GB    GCG_5222	
'Gui.FrmPO.GsGCOSV.Event(RowCellClick,GsGCOSV_RowCellClick)
Gui.FrmPO.GsGcReqs.Create(GsGridControl)
Gui.FrmPO.GsGcReqs.Size(15000,8655)
Gui.FrmPO.GsGcReqs.Position(0,0)
Gui.FrmPO.GsGcReqs.Parent("tabPODash",4)
Gui.FrmPO.progressBar1.Create(ProgressBar)
Gui.FrmPO.progressBar1.Visible(False)
Gui.FrmPO.progressBar1.Size(3750,255)
Gui.FrmPO.progressBar1.Position(75,360)
Gui.FrmPO.lbl1.Create(Label,"***Change***",False,3750,255,0,75,120,True,0,"Arial",8,-2147483633,0)
Gui.FrmPO.picGSSLogo.Create(PictureBox)
Gui.FrmPO.picGSSLogo.Size(4125,960)
Gui.FrmPO.picGSSLogo.Position(5520,45)
Gui.FrmPO.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.FrmPO.picGSSLogo.ToolTip("Double-Click for additional functions")
Gui.FrmPO.framePermissions.Create(Frame)
Gui.FrmPO.framePermissions.Size(2415,420)
Gui.FrmPO.framePermissions.Position(12630,585)
Gui.FrmPO.optView.Create(Option)
Gui.FrmPO.optView.Caption("View")
Gui.FrmPO.optView.Event(Click,optView_Click)
Gui.FrmPO.optView.Parent("framePermissions")
Gui.FrmPO.optView.Size(690,195)
Gui.FrmPO.optView.Position(90,165)
Gui.FrmPO.optEdit.Create(Option)
Gui.FrmPO.optEdit.Caption("Edit")
Gui.FrmPO.optEdit.Enabled(False)
Gui.FrmPO.optEdit.Event(Click,optEdit_Click)
Gui.FrmPO.optEdit.Parent("framePermissions")
Gui.FrmPO.optEdit.Size(660,195)
Gui.FrmPO.optEdit.Position(780,165)
Gui.FrmPO.optRecv.Create(Option)
Gui.FrmPO.optRecv.Enabled(False)
Gui.FrmPO.optRecv.Caption("Receive")
Gui.FrmPO.optRecv.BackColor(15790320)
Gui.FrmPO.optRecv.ForeColor(0)
Gui.FrmPO.optRecv.Event(Click,optRecv_Click)
Gui.FrmPO.optRecv.Parent("framePermissions")
Gui.FrmPO.optRecv.Size(945,195)
Gui.FrmPO.optRecv.Position(1440,165)
Gui.FrmPO.frameButtons.Create(Frame)
Gui.FrmPO.frameButtons.Size(2850,600)
Gui.FrmPO.frameButtons.Position(12195,75)
Gui.FrmPO.cmdExport.Create(Button)
Gui.FrmPO.cmdExport.Size(840,375)
Gui.FrmPO.cmdExport.Caption("Export")
Gui.FrmPO.cmdExport.Event(Click,cmdExport_Click)
Gui.FrmPO.cmdExport.Parent("frameButtons")
Gui.FrmPO.cmdExport.Position(1020,165)
Gui.FrmPO.cmdRefresh.Create(Button)
Gui.FrmPO.cmdRefresh.Size(840,375)
Gui.FrmPO.cmdRefresh.Position(90,165)
Gui.FrmPO.cmdRefresh.Caption("REFRESH")
Gui.FrmPO.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.FrmPO.cmdRefresh.Parent("frameButtons")
Gui.FrmPO.cmdNewPO.Create(Button)
Gui.FrmPO.cmdNewPO.Size(840,375)
Gui.FrmPO.cmdNewPO.Position(1950,165)
Gui.FrmPO.cmdNewPO.Parent("frameButtons")
Gui.FrmPO.cmdNewPO.Caption("New PO")
Gui.FrmPO.cmdNewPO.Event(Click,cmdNewPO_Click)
Gui.frmWeb..Create
Gui.frmWeb..Caption("Global Shop Solutions - Web Sites")
Gui.frmWeb..Size(3990,2025)
Gui.frmWeb..MinX(0)
Gui.frmWeb..MinY(0)
Gui.frmWeb..Position(0,0)
Gui.frmWeb..BackColor(-2147483633)
Gui.frmWeb..MousePointer(0)
Gui.frmWeb..MaxButton(False)
Gui.frmWeb..Sizeable(False)
Gui.frmWeb..Event(UnLoad,frmWeb_UnLoad)
Gui.frmWeb..MinButton(False)
Gui.frmWeb.cmdGSS.Create(Button)
Gui.frmWeb.cmdGSS.Size(3615,375)
Gui.frmWeb.cmdGSS.Position(120,45)
Gui.frmWeb.cmdGSS.Caption("Global Shop Solutions")
Gui.frmWeb.cmdGSS.Event(Click,cmdGSS_Click)
Gui.frmWeb.cmdServ.Create(Button)
Gui.frmWeb.cmdServ.Size(3615,375)
Gui.frmWeb.cmdServ.Position(120,450)
Gui.frmWeb.cmdServ.Caption("ServiceWeb")
Gui.frmWeb.cmdServ.Event(Click,cmdServ_Click)
Gui.frmWeb.cmdUpd.Create(Button)
Gui.frmWeb.cmdUpd.Size(3615,375)
Gui.frmWeb.cmdUpd.Position(120,855)
Gui.frmWeb.cmdUpd.Caption("GSS Updates")
Gui.frmWeb.cmdUpd.Event(Click,cmdUpd_Click)
Gui.frmWeb.cmdResetGsGC.Create(Button)
Gui.frmWeb.cmdResetGsGC.Size(3615,375)
Gui.frmWeb.cmdResetGsGC.Position(120,1260)
Gui.frmWeb.cmdResetGsGC.Caption("Reset All Columns")
Gui.frmWeb.cmdResetGsGC.Event(Click,cmdResetGsGC_Click)
Gui.frmNewPO..Create
Gui.frmNewPO..Caption("New PO")
Gui.frmNewPO..Size(2460,1200)
Gui.frmNewPO..MinX(2460)
Gui.frmNewPO..MinY(1200)
Gui.frmNewPO..Position(0,0)
Gui.frmNewPO..BackColor(-2147483633)
Gui.frmNewPO..MaxButton(False)
Gui.frmNewPO..MinButton(False)
Gui.frmNewPO..MousePointer(0)
Gui.frmNewPO..Sizeable(False)
Gui.frmNewPO..Event(UnLoad,frmNewPO_UnLoad)
Gui.frmNewPO.cmdManualPO.Create(Button)
Gui.frmNewPO.cmdManualPO.Size(2175,375)
Gui.frmNewPO.cmdManualPO.Position(90,60)
Gui.frmNewPO.cmdManualPO.Caption("Purchase Orders (Manual)")
Gui.frmNewPO.cmdManualPO.Event(Click,cmdManualPO_Click)
Gui.frmNewPO.cmdAutoPO.Create(Button)
Gui.frmNewPO.cmdAutoPO.Size(2175,375)
Gui.frmNewPO.cmdAutoPO.Position(90,480)
Gui.frmNewPO.cmdAutoPO.Caption("Automated Purchasing")
Gui.frmNewPO.cmdAutoPO.Event(Click,cmdAutoPO_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.iPrintAudit.Declare
	V.Global.bLoadData.Declare
	V.Global.bLongPart.Declare
Program.Sub.Preflight.End

Program.Sub.Main.Start
'customer Whittle Flooring wants the PO-dashboard 4163 modified to not allow hyperlinks and remove the cost and extension columns
'GaryB    GCG_5222	      09/04/18
'I will leave code in the program and comment it out
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sIcon.Declare
	V.Local.bEditGrp.Declare
	V.Local.sGssLogo.Declare

	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
	Gui.frmWeb..Icon(V.Local.sIcon)
	Gui.frmNewPO..Icon(V.Local.sIcon)
	Gui.FrmPO..Icon(V.Local.sIcon)
	Gui.FrmPO.picGSSLogo.Picture(V.Local.sGssLogo)

	Gui.FrmPO.tabPODash.SetTab(0)

	F.Intrinsic.Control.CallSub(SetAnchors)
	F.Intrinsic.Control.CallSub(CheckLongPart)
	
	'Check Print Audit Option
	F.Global.General.ReadOption(400367,3,0000,V.Global.iPrintAudit)
'GB    GCG_5222
	'Check iF the User is in EDIT Group, to enable the Edit button to edit SO
'	F.Global.Security.IsInGroup(V.Caller.User,"EditPO",V.Local.bEditGrp)
'	F.Intrinsic.Control.IF(V.Local.bEditGrp,=,False)
		Gui.FrmPO.optEdit.Enabled(False)
		Gui.FrmPO.cmdNewPO.Enabled(False)
'	F.Intrinsic.Control.Else
'		Gui.FrmPO.optEdit.Enabled(True)
'		Gui.FrmPO.cmdNewPO.Enabled(True)
'	F.Intrinsic.Control.EndIF
'GB    GCG_5222
	'Check if the User is in RECEIVE Group, to enable the Edit button to edit SO
'	F.Global.Security.IsInGroup(V.Caller.User,"RECEIVE",V.Local.bEditGrp)
'	F.Intrinsic.Control.If(V.Local.bEditGrp,=,False)
		Gui.FrmPO.optRecv.Enabled(False)
'	F.Intrinsic.Control.Else
'		Gui.FrmPO.optRecv.Enabled(True)
'	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,300)

	F.Intrinsic.Control.CallSub(controlsdisabled)
	Gui.FrmPO..Show
	F.Intrinsic.Control.CallSub(SetTabAnchors)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(callsubs)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.CallSub(controlsenabled)
	Gui.FrmPO.optView.Value(True)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.cmdRefresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(controlsdisabled)
	F.Intrinsic.Control.BlockEvents 
	F.Intrinsic.Control.CallSub(callsubs)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.CallSub(controlsenabled)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.CheckLongPart.Start
	F.Global.General.ReadOption("400861",0,False,"0000",V.Global.bLongPart)
	F.Intrinsic.Control.If(V.Global.bLongPart,=,False)
		F.Global.General.ReadOption("400861",0,False,"0004",V.Global.bLongPart)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckLongPart.End

Program.Sub.LoadDTAllPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Check to see if DataTable already Exists and if so, close it
	F.Intrinsic.Control.IF(V.DataTable.dtAllPOs.Exists)
		F.Data.DataTable.Close("dtAllPOs")
		Gui.FrmPO.GsGCAllPOs.ClearGrouping("gvAllPOs")
	F.Intrinsic.Control.EndIF
	
	V.Global.bLoadData.Set(True)

	'Create DataTable from SQL
''GB    GCG_5222
'	V.Local.sSQL.Declare(String,"SELECT DISTINCT CASE WHEN D.CONF IS NULL THEN CONVERT(0,SQL_BIT) WHEN CONF = 0 THEN CONVERT(0,SQL_BIT) WHEN CONF = 1 THEN CONVERT(1,SQL_BIT) END AS CONF,A.PURCHASE_ORDER,LEFT(A.RECORD_NO,3) AS RECORD_NO,B.NAME_VENDOR,COALESCE(A.PART,'') AS PART,'' As DISPLAY_PART,A.LOCATION,A.DESCRIPTION, A.PRODUCT_LINE,C.BUYER,C.DATE_ORDER AS PO_DATE,A.DATE_DUE_LINE,A.QTY_ORDER, A.QTY_RECEIVED,(A.QTY_ORDER-A.QTY_RECEIVED)AS QTY_OPEN,A.QTY_RECD_NOT_INSP,A.COST,A.EXTENSION,A.JOB,A.SUFFIX,RTrim(C.SHIP_VIA) As SHIP_VIA,A.BLANKET_PO,CASE WHEN TYPE = 0 THEN IF(SUBSTRING(PART,17,1) = '*','Outside','Normal') WHEN TYPE = 1 THEN 'Blanket' END AS TYPE,RTrim(F.SHIP_TO_SEQ) AS SHIPTO,E.NOTES,A.USER_5,Cast(Case Requires_Insp When 'Y' Then 1 Else 0 End As Bit) As Requires_Insp From V_PO_LINES A LEFT JOIN V_PO_VENDOR_BUY B ON A.PURCHASE_ORDER = B.PURCHASE_ORDER LEFT JOIN V_PO_HEADER C ON A.PURCHASE_ORDER=C.PURCHASE_ORDER LEFT JOIN GAB_PO_CONFCHK D ON A.PURCHASE_ORDER=D.PURCHASE_ORDER LEFT JOIN GAB_4163_PO_NOTES E ON A.PURCHASE_ORDER = E.PO AND A.RECORD_NO = CONCAT(E.POLINE,0) LEFT JOIN V_PO_PAY_TO F ON A.PURCHASE_ORDER = F.PURCHASE_ORDER WHERE C.FLAG_RECV_CLOSED <> 'Y' And A.FLAG_RECV_CLOSE <> 'Y' And QTY_OPEN <> 0 ORDER BY A.DATE_DUE_LINE;")	
	V.Local.sSQL.Declare(String,"SELECT DISTINCT CASE WHEN D.CONF IS NULL THEN CONVERT(0,SQL_BIT) WHEN CONF = 0 THEN CONVERT(0,SQL_BIT) WHEN CONF = 1 THEN CONVERT(1,SQL_BIT) END AS CONF,A.PURCHASE_ORDER,LEFT(A.RECORD_NO,3) AS RECORD_NO,B.NAME_VENDOR,COALESCE(A.PART,'') AS PART,'' As DISPLAY_PART,A.LOCATION,A.DESCRIPTION, A.PRODUCT_LINE,C.BUYER,C.DATE_ORDER AS PO_DATE,A.DATE_DUE_LINE,A.QTY_ORDER, A.QTY_RECEIVED,(A.QTY_ORDER-A.QTY_RECEIVED)AS QTY_OPEN,A.QTY_RECD_NOT_INSP,A.JOB,A.SUFFIX,RTrim(C.SHIP_VIA) As SHIP_VIA,A.BLANKET_PO,CASE WHEN TYPE = 0 THEN IF(SUBSTRING(PART,17,1) = '*','Outside','Normal') WHEN TYPE = 1 THEN 'Blanket' END AS TYPE,RTrim(F.SHIP_TO_SEQ) AS SHIPTO,E.NOTES,A.USER_5,Cast(Case Requires_Insp When 'Y' Then 1 Else 0 End As Bit) As Requires_Insp From V_PO_LINES A LEFT JOIN V_PO_VENDOR_BUY B ON A.PURCHASE_ORDER = B.PURCHASE_ORDER LEFT JOIN V_PO_HEADER C ON A.PURCHASE_ORDER=C.PURCHASE_ORDER LEFT JOIN GAB_PO_CONFCHK D ON A.PURCHASE_ORDER=D.PURCHASE_ORDER LEFT JOIN GCG_5222_PO_NOTES E ON A.PURCHASE_ORDER = E.PO AND A.RECORD_NO = CONCAT(E.POLINE,0) LEFT JOIN V_PO_PAY_TO F ON A.PURCHASE_ORDER = F.PURCHASE_ORDER WHERE C.FLAG_RECV_CLOSED <> 'Y' And A.FLAG_RECV_CLOSE <> 'Y' And QTY_OPEN <> 0 ORDER BY A.DATE_DUE_LINE;")
	F.Data.DataTable.CreateFromSQL("dtAllPOs","con",V.Local.sSQL,True)
	F.Data.DataTable.AddDisplayPartColumn("dtAllPOs",0,"PART","DISPLAY_PART")

	'Call Subroutine to build GridView to Grid on form
	F.Intrinsic.Control.CallSub(LoadDvGvAllPOs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTAllPOs.End

Program.Sub.LoadDvGvAllPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCAllPOs.AddGridviewFromDatatable("gvAllPOs","dtAllPOs")
	Gui.FrmPO.GsGCAllPOs.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","MultiSelect",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","AllowSort",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","AllowFilter",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCAllPOs.SetGridviewProperty("gvAllPOs","OptionsFilterUseNewCustomFilterDialog",True)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","Visible",False)

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","Caption","PO #")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
'GB    GCG_5222	
'	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","Caption",V.Local.sCaption)
'	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","Caption","Job")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","Caption","Type")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","Caption","Req. Insp.")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Conf","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","MinWidth","85")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","MinWidth","95")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","MinWidth","55")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","MinWidth","85")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","HeaderFontBold",True)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","HeaderFontBold",True)
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","HeaderHAlignment","Center")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","CellHAlignment","Center")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","Fixed","Left")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","Fixed","Left")	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","AllowEdit",False)	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","AllowEdit",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","AllowEdit",False)
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","AllowEdit",False)

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","ReadOnly",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","CellForeColor","Blue")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","CellForeColor","Blue")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","CellForeColor","Blue")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","CellForeColor","Blue")
'	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","CellForeColor","Blue")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
'GB    GCG_5222
'	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value)
'		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
'		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
'	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",True)
'	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
	F.Data.DataTable.Select("dtAllPOs","Requires_Insp = True",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",1,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",1,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",1,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	'Past Due mark Pink
	F.Intrinsic.String.Build("DATE_DUE_LINE < #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sExp)
	F.Data.DataTable.Select("dtAllPOs",V.Local.sExp,V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCAllPOs.SetRowAppearance("gvAllPOs",V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Pink")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf

	Gui.FrmPO.GsGCAllPOs.ResumeLayout()
	Gui.FrmPO.GsGCAllPOs.MainView("gvAllPOs")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvAllPOs.End

Program.Sub.LoadDTExpToday.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.IF(V.DataTable.dtExpToday.Exists,=,True)
		F.Data.DataTable.Close("dtExpToday")
		Gui.FrmPO.GsGCExpToday.ClearGrouping("gvExpToday")
	F.Intrinsic.Control.EndIF

	F.Intrinsic.String.Build("DATE_DUE_LINE = #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sFilter)
	F.Data.DataView.Create("dtAllPOs","dvExpToday",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtAllPOs","dvExpToday","dtExpToday",True)

	F.Intrinsic.Control.CallSub(loaddvgvexptoday)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTExpToday.End

Program.Sub.LoadDvGvExpToday.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCExpToday.AddGridviewFromDatatable("gvExpToday","dtExpToday")
	Gui.FrmPO.GsGCExpToday.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","MultiSelect",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","AllowSort",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","AllowFilter",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCExpToday.SetGridviewProperty("gvExpToday","OptionsFilterUseNewCustomFilterDialog",True)
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","Visible",False)

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","Caption","PO #")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
'GB    GCG_5222	
'	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","Caption",V.Local.sCaption)
'	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","Caption","Job")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","Caption","Type")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","Caption","User Field 5 (30 Characters)")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Conf","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","MinWidth","85")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","MinWidth","95")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","MinWidth","55")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","MinWidth","200")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","HeaderFontBold",True)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","HeaderFontBold",True)
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","HeaderHAlignment","Center")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","CellHAlignment","Center")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","Fixed","Left")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","Fixed","Left")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","AllowEdit",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","AllowEdit",False)
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","AllowEdit",True)

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","ReadOnly",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","CellForeColor","Blue")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","CellForeColor","Blue")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","CellForeColor","Blue")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","CellForeColor","Blue")
'	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","CellForeColor","Blue")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",True)
	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
	F.Data.DataTable.Select("dtExpToday","Requires_Insp = True",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",1,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",1,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",1,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.GsGCExpToday.ResumeLayout()
	Gui.FrmPO.GsGCExpToday.MainView("gvExpToday")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvExpToday.End

Program.Sub.LoadDTPastDue.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.IF(V.DataTable.dtPastDue.Exists,=,True)
		F.Data.DataTable.Close("dtPastDue")
		Gui.FrmPO.GsGCPastDue.ClearGrouping("gvPastDue")
	F.Intrinsic.Control.EndIF

	F.Intrinsic.String.Build("DATE_DUE_LINE < #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sFilter)
	F.Data.DataView.Create("dtAllPOs","dvPastDue",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtAllPOs","dvPastDue","dtPastDue",True)

	F.Intrinsic.Control.CallSub(loaddvgvpastdue)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTPastDue.End

Program.Sub.LoadDvGvPastDue.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCPastDue.AddGridviewFromDatatable("gvPastDue","dtPastDue")
	Gui.FrmPO.GsGCPastDue.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","MultiSelect",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","AllowSort",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","AllowFilter",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCPastDue.SetGridviewProperty("gvPastDue","OptionsFilterUseNewCustomFilterDialog",True)
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","Visible",False)

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","Caption","PO #")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
'GB    GCG_5222	
'	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","Caption",V.Local.sCaption)
'	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","Caption","Job")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","Caption","Type")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","Caption","User Field 5 (30 Characters)")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Conf","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","MinWidth","85")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","MinWidth","95")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","MinWidth","55")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","MinWidth","200")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","HeaderFontBold",True)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","HeaderFontBold",True)
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
'GB    GCG_5222	
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","HeaderHAlignment","Center")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","CellHAlignment","Center")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","Fixed","Left")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","Fixed","Left")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","AllowEdit",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","AllowEdit",False)
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","AllowEdit",True)

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","ReadOnly",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","CellForeColor","Blue")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","CellForeColor","Blue")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","CellForeColor","Blue")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","CellForeColor","Blue")
'	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","CellForeColor","Blue")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",True)
	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
	F.Data.DataTable.Select("dtPastDue","Requires_Insp = True",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",1,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",1,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",1,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor","Blue")
			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.GsGCPastDue.ResumeLayout()
	Gui.FrmPO.GsGCPastDue.MainView("gvPastDue")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvPastDue.End

Program.Sub.LoadDTReqs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.IF(V.DataTable.dtReqs.Exists)
		F.Data.DataTable.Close("dtReqs")
		Gui.FrmPO.GsGCReqs.ClearGrouping("gvReqs")
	F.Intrinsic.Control.EndIF
'GB    GCG_5222		
'	F.Data.DataTable.CreateFromSQL("dtReqs","con","SELECT PR.PO_REQ_NUMBER, PR.PO_REQ_LINE, PR.VENDOR, PR.PRODUCT_LINE, COALESCE(PR.PART,'') AS PART,'' As DISPLAY_PART, PR.LOCATION, PR.DESCRIPTION, PR.DATE_DUE, PR.QUANTITY, PR.UNIT_PRICE, (SELECT (QUANTITY * UNIT_PRICE) FROM V_PURCHASE_REQS WHERE PR.PO_REQ_NUMBER = PO_REQ_NUMBER AND PR.PO_REQ_LINE = PO_REQ_LINE) AS EXTENSION , PR.BUYER, PR.JOB, PR.SUFFIX, CASE WHEN PR.SEQUENCE = '000000' THEN ' ' WHEN PR.SEQUENCE <> '000000' THEN PR.SEQUENCE END AS SEQUENCE,PR.UM,PR.GL_ACCOUNT,PR.DATE_ORIGINAL,PR.SORT_CODE,PR.USER_REF,PR.INVENTORY_UM,PR.INVENTORY_QTY,PR.USERID_ORIGINATOR FROM V_PURCHASE_REQS PR;",True)
	F.Data.DataTable.CreateFromSQL("dtReqs","con","SELECT PR.PO_REQ_NUMBER, PR.PO_REQ_LINE, PR.VENDOR, PR.PRODUCT_LINE, COALESCE(PR.PART,'') AS PART,'' As DISPLAY_PART, PR.LOCATION, PR.DESCRIPTION, PR.DATE_DUE, PR.QUANTITY, PR.UNIT_PRICE, PR.BUYER, PR.JOB, PR.SUFFIX, CASE WHEN PR.SEQUENCE = '000000' THEN ' ' WHEN PR.SEQUENCE <> '000000' THEN PR.SEQUENCE END AS SEQUENCE,PR.UM,PR.GL_ACCOUNT,PR.DATE_ORIGINAL,PR.SORT_CODE,PR.USER_REF,PR.INVENTORY_UM,PR.INVENTORY_QTY,PR.USERID_ORIGINATOR FROM V_PURCHASE_REQS PR;",True)
	F.Data.DataTable.AddDisplayPartColumn("dtReqs",0,"PART","DISPLAY_PART")

	'Add buyer name from BUYERS table using PURCHASE_REQS.BUYER
	F.Data.Dictionary.CreateFromSQL("dBuyer","con","SELECT BUYER_CODE AS BUYER, BUYER AS BUYER_NAME FROM V_BUYERS;")
	F.Data.Dictionary.SetDefaultReturn("dBuyer","")
	F.Data.DataTable.FillFromDictionary("dtReqs","dBuyer","BUYER")
	F.Data.Dictionary.Close("dBuyer")

	'Add vendor name from VENDOR_MASTER using PURCHASE_REQS.VENDOR
	F.Data.Dictionary.CreateFromSQL("dVendor","con","SELECT VENDOR, NAME_VENDOR AS VENDOR FROM V_VENDOR_MASTER;")
	F.Data.Dictionary.SetDefaultReturn("dVendor","")
	F.Data.DataTable.FillFromDictionary("dtReqs","dVendor","VENDOR")
	F.Data.Dictionary.Close("dVendor")
	
	F.Intrinsic.Control.CallSub(loaddvgvreqs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTReqs.End

Program.Sub.LoadDvGvReqs.Start
	F.Intrinsic.Control.Try
	v.Local.sError.Declare
	
	v.Local.sCaption.Declare

	Gui.FrmPO.GsGcReqs.AddGridviewFromDatatable("gvReqs","dtReqs")
	Gui.FrmPO.GsGcReqs.SuspendLayout()
	
	'Set grid properties
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","MultiSelect",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowSort",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowFilter",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGcReqs.SetGridviewProperty("gvReqs","OptionsFilterUseNewCustomFilterDialog",True)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","Visible",False)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","Caption","Req #")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","Caption","Ln")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","Caption","Due Date")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","Caption","Order Qty")
'GB    GCG_5222	
'	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,v.Local.sCaption)
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","Caption",v.Local.sCaption)
'	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,v.Local.sCaption)
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","Caption",v.Local.sCaption)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","Caption","Job")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","Caption","Seq")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","Caption","Pur UM")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","Caption","GL Account")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","Caption","Date Req")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","Caption","Sort Code")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","Caption","User Ref")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","Caption","Inv UM")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","Caption","Inv Qty")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","Caption","Originator")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","AllowEdit",False)
'GB    GCG_5222	
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","AllowEdit",False)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","MinWidth","75")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","MinWidth","15")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","MinWidth","200")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","MinWidth","25")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","MinWidth","30")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","MinWidth","80")
'GB    GCG_5222
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","MinWidth","100")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","MinWidth","130")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","MinWidth","75")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","MinWidth","50")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","MinWidth","50")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","MinWidth","60")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","MinWidth","90")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","MinWidth","70")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","MinWidth","65")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","MinWidth","60")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","MinWidth","80")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","HeaderFontBold",True)
'GB    GCG_5222	
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","HeaderFontBold",True)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","HeaderHAlignment","Center")
'GB    GCG_5222	
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","CellHAlignment","Right")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","CellHAlignment","Right")
'GB    GCG_5222	
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","CellHAlignment","Right")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","CellHAlignment","Center")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","Fixed","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","Fixed","Left")

	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","DisplayCustomDatetime","d")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","DisplayCustomNumeric","##.00")
'GB    GCG_5222	
'	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","DisplayCustomNumeric","##.00")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.GsGcReqs.ResumeLayout()
	Gui.frmPO.GsGcReqs.MainView("gvReqs")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
	
Program.Sub.LoadDvGvReqs.End

Program.Sub.GsGCAllPOs_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare

	F.Intrinsic.Control.SelectCase(v.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Global.General.CallWrapperSync(3200,V.Local.sPO)
				F.Intrinsic.Control.CallSub(printaudit)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
			F.Global.General.CallWrapperASync(7200,V.Local.sParams)

	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllPOs_RowCellClick.End

Program.Sub.GsGCExpToday_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare

	F.Intrinsic.Control.SelectCase(v.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Global.General.CallWrapperASync(3200,V.Local.sPO)
				F.Intrinsic.Control.CallSub(printaudit)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
			F.Global.General.CallWrapperASync(7200,V.Local.sParams)

	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCExpToday_RowCellClick.End

Program.Sub.GsGCPastDue_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare

	F.Intrinsic.Control.SelectCase(v.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Global.General.CallWrapperASync(3200,V.Local.sPO)
				F.Intrinsic.Control.CallSub(printaudit)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
			F.Global.General.CallWrapperASync(7200,V.Local.sParams)

	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPastDue_RowCellClick.End

Program.Sub.SetAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Anchor Values
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmPO.picGSSLogo.Anchor(1)
	Gui.FrmPO.frameButtons.Anchor(9)
	Gui.FrmPO.framePermissions.Anchor(9)
	Gui.FrmPO.tabPODash.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetAnchors.End

Program.Sub.SetTabAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Anchor Values
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmPO.GsGCAllPOs.Anchor(15)
	Gui.FrmPO.GsGCExpToday.Anchor(15)
	Gui.FrmPO.GsGCPastDue.Anchor(15)
	Gui.FrmPO.GsGCOSV.Anchor(15)
	Gui.FrmPO.GsGcReqs.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetTabAnchors.End

Program.Sub.FrmPO_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End

	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.FrmPO_UnLoad.End

Program.Sub.ControlsDisabled.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.frameButtons.Enabled(False)
	Gui.FrmPO.framePermissions.Enabled(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ControlsDisabled.End

Program.Sub.ControlsEnabled.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.frameButtons.Enabled(True)
	Gui.FrmPO.framePermissions.Enabled(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ControlsEnabled.End

Program.Sub.CallSubs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.lbl1.Visible(True)
	Gui.FrmPO.progressBar1.Visible(True)
	Gui.FrmPO.lbl1.Caption("Loading Purchase Orders....")
	Gui.FrmPO.progressBar1.Min(0)
	Gui.FrmPO.progressBar1.Max(100)
	F.Intrinsic.Control.CallSub(loaddtallpos)
	Gui.FrmPO.progressBar1.Value(20)
	F.Intrinsic.Control.CallSub(loaddtexptoday)
	Gui.FrmPO.progressBar1.Value(40)
	F.Intrinsic.Control.CallSub(loaddtpastdue)
	Gui.FrmPO.progressBar1.Value(60)
	F.Intrinsic.Control.CallSub(loaddtosv)
	Gui.FrmPO.progressBar1.Value(80)
	F.Intrinsic.Control.CallSub(loaddtreqs)
	Gui.FrmPO.progressBar1.Value(100)
	Gui.FrmPO.lbl1.Visible(False)
	Gui.FrmPO.progressBar1.Value(0)
	Gui.FrmPO.progressBar1.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CallSubs.End

Program.Sub.GsGCAllPOs_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConf.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
'GB   5222
'			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
                        F.Intrinsic.String.Build("SELECT * FROM GCG_5222_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
'GB   5222
'				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.Intrinsic.String.Build("INSERT INTO GCG_5222_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
'GB    5222
'				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.Intrinsic.String.Build("UPDATE GCG_5222_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvAllPOs","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAllPOs","PO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllPOs_CellValueChanged.End

Program.Sub.GsGCExpToday_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConf.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
'GB   5222
'			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.Intrinsic.String.Build("SELECT * FROM GCG_5222_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
'GB   5222
'				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.Intrinsic.String.Build("INSERT INTO GCG_5222_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
                         	F.Intrinsic.String.Build("UPDATE GCG_5222_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvExpToday","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvExpToday","PO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCExpToday_CellValueChanged.End

Program.Sub.GsGCPastDue_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConf.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
'GB    5222
'			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
                        F.Intrinsic.String.Build("SELECT * FROM GCG_5222_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
'GB    5222
'				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
                                F.Intrinsic.String.Build("INSERT INTO GCG_5222_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
'GB    5222
'				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
                                F.Intrinsic.String.Build("UPDATE GCG_5222_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvPastDue","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvPastDue","PO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPastDue_CellValueChanged.End

Program.Sub.optView_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optView_Click.End

Program.Sub.optEdit_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optEdit_Click.End

Program.Sub.optRecv_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optRecv_Click.End

Program.Sub.CheckPOConf.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPOConf.End

Program.Sub.CheckNote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sLine.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	F.Intrinsic.Control.If(V.Args.PO_Note,=,"NOTES")
		F.Intrinsic.Control.If(V.Args.GV,=,"gvAllPOs")
			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.ElseIf(V.Args.GV,=,"gvPastDue")
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.Else
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Args.PO_Note,=,"USER_5")
		F.Intrinsic.Control.If(V.Args.GV,=,"gvAllPOs")
			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.ElseIf(V.Args.GV,=,"gvPastDue")
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.Else
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckNote.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bExists.Declare

	Gui.FrmPO.lbl1.Caption("Checking Database Table....")
'GB    5222
'	F.ODBC.Connection!con.TableExists("GAB_4163_PO_NOTES",V.Local.bExists)
'	F.Intrinsic.Control.If(V.Local.bExists,=,False)
'		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_4163_PO_NOTES(PO CHAR(7),POLINE CHAR(3),NOTES LONGVARCHAR);")
'		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4163_PO_NOTES01 USING 1 ON GAB_4163_PO_NOTES(PO);")
'		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4163_PO_NOTES02 USING 2 ON GAB_4163_PO_NOTES(POLINE);")
'	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!con.TableExists("GCG_5222_PO_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GCG_5222_PO_NOTES(PO CHAR(7),POLINE CHAR(3),NOTES LONGVARCHAR);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GCG_5222_PO_NOTES01 USING 1 ON GCG_5222_PO_NOTES(PO);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GCG_5222_PO_NOTES02 USING 2 ON GCG_5222_PO_NOTES(POLINE);")
	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!con.TableExists("GAB_PO_CONFCHK",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_PO_CONFCHK(PURCHASE_ORDER CHAR(7),CONF CHAR(1),GS_USER CHAR(8),DATE_CONF DATE);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_PO_CONFCHK00 ON GAB_PO_CONFCHK(PURCHASE_ORDER ASC);")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.cmdExport_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)

	F.Intrinsic.Control.SelectCase(V.Screen.FrmPO!tabPODash.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.Local.bExcel)
'GB    5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_AllPOs_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.String.Build("{0}\GCG_5222_AllPOs_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCAllPOs.Export(V.Local.sFileExport,"xlsx")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_AllPOs_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_AllPOs_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCAllPOs.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.Local.bExcel)
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_ExpToday_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_ExpToday_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCExpToday.Export(V.Local.sFileExport,"xlsx")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_ExpToday_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_ExpToday_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCExpToday.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(2)
			F.Intrinsic.Control.If(V.Local.bExcel)
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_PastDue_Export.xls",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_PastDue_Export.xls",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCPastDue.Export(V.Local.sFileExport,"xls")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_PastDue_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_PastDue_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCPastDue.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(3)
			F.Intrinsic.Control.If(V.Local.bExcel)
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_Outside_Export.xls",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_Outside_Export.xls",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCOSV.Export(V.Local.sFileExport,"xls")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_Outside_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_Outside_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGCOSV.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case(4)
			F.Intrinsic.Control.If(v.Local.bExcel)
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_Outside_Export.xls",v.Caller.LocalGSSTempDir,v.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_Outside_Export.xls",v.Caller.LocalGSSTempDir,v.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(v.Local.sFileExport,v.Local.bFileLocked)
				F.Intrinsic.Control.If(v.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",v.Ambient.NewLine,v.Local.sFileExport,v.Local.sMsg)
					F.Intrinsic.UI.Msgbox(v.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGcReqs.Export(v.Local.sFileExport,"xls")
					F.Intrinsic.Task.ShellExec(0,"",v.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
'GB   5222
'				F.Intrinsic.String.Build("{0}\GAB_4163_Outside_Export.csv",v.Caller.LocalGSSTempDir,v.Local.sFileExport)
                                F.Intrinsic.String.Build("{0}\GCG_5222_Outside_Export.csv",v.Caller.LocalGSSTempDir,v.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(v.Local.sFileExport,v.Local.bFileLocked)
				F.Intrinsic.Control.If(v.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",v.Ambient.NewLine,v.Local.sFileExport,v.Local.sMsg)
					F.Intrinsic.UI.Msgbox(v.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmPO.GsGcReqs.Export(v.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",v.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdExport_Click.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmWeb..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.frmWeb_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmWeb..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmWeb_UnLoad.End

Program.Sub.cmdGSS_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdGSS_Click.End

Program.Sub.cmdServ_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-service.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdServ_Click.End

Program.Sub.cmdUpd_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-updates.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdUpd_Click.End

Program.Sub.LoadDTOSV.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Check to see if DataTable already Exists and if so, close it
	F.Intrinsic.Control.IF(V.DataTable.dtOSV.Exists,=,True)
		F.Data.DataTable.Close("dtOSV")
		Gui.FrmPO.GsGCOSV.ClearGrouping("gvOSV")
	F.Intrinsic.Control.EndIF

	'Create DataTable from SQL
	V.Local.sSQL.Declare(String,"SELECT C.OPERATION AS VENDOR,D.NAME_VENDOR,COALESCE(B.PART,'') AS MFG_PART,'' As DISPLAY_PART,C.DESCRIPTION,A.QUANTITY,A.JOB,A.JOB_SUFFIX,A.SEQUENCE,C.DATE_DUE,B.DATE_DUE AS JOB_DATE_DUE FROM V_MAT_ONLINE A LEFT OUTER JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.JOB_SUFFIX = B.SUFFIX LEFT OUTER JOIN V_JOB_OPERATIONS C ON A.JOB = C.JOB AND A.JOB_SUFFIX = C.SUFFIX AND A.SEQUENCE = C.SEQ LEFT JOIN V_VENDOR_MASTER D ON C.OPERATION = D.VENDOR WHERE A.MOL_DELETE<>'Y' AND A.MOL_TYPE='O' ORDER BY C.DATE_DUE,C.OPERATION;")
	F.Data.DataTable.CreateFromSQL("dtOSV","con",V.Local.sSQL,True)
	F.Data.DataTable.AddDisplayPartColumn("dtOSV",0,"MFG_PART","DISPLAY_PART")

	'Call Subroutine to build DataView, GridView and set GridView to Grid on form
	F.Intrinsic.Control.CallSub(loaddvgvosv)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTOSV.End

Program.Sub.LoadDvGvOSV.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.iCnt.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCOSV.AddGridViewFromDataTable("gvOSV","dtOSV")
	Gui.FrmPO.GsGCOSV.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","MultiSelect",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","AllowSort",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","AllowFilter",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCOSV.SetGridviewProperty("gvOSV","OptionsFilterUseNewCustomFilterDialog",True)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","Visible",False)
	
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","Caption","Vendor")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","Caption","Mfg Part")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","Caption","Quantity")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","Caption","Job")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","Caption","Seq")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","Caption","Outside Due Date")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","Caption","WO Due Date")	

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","MinWidth","30")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","MinWidth","150")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","MinWidth","120")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","MinWidth","180")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","MinWidth","60")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","MinWidth","95")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","MinWidth","90")
	
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","HeaderFontBold",True)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","HeaderHAlignment","Center")

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","CellHAlignment","Far")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","CellHAlignment","Center")
'GB    GCG_5222
'	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","CellForeColor","Blue")

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","AllowEdit",False)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","ReadOnly",True)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	Gui.FrmPO.GsGCOSV.ResumeLayout()
	Gui.FrmPO.GsGCOSV.MainView("gvOSV")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvOSV.End

Program.Sub.GsGCOSV_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("DISPLAY_PART")
		F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,False)
			F.Global.General.LaunchMenuTask(296,0,V.Local.iRet)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCOSV_RowCellClick.End

Program.Sub.cmdResetGsGC_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
'GB   5222
'	F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 4163 And Seq = 1000;")
        F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 5222 And Seq = 1000;")
	F.ODBC.Connection!common.Close
	
	Gui.frmWeb..Visible(False)
	V.Global.bLoadData.Set(False)
	F.Intrinsic.Control.CallSub(cmdReFresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdResetGsGC_Click.End

Program.Sub.cmdNewPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNewPO..Show

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdNewPO_Click.End

Program.Sub.frmNewPO_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNewPO..Visible(False)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmNewPO_UnLoad.End

Program.Sub.cmdManualPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	
	Gui.frmNewPO..Visible(False)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt)
	F.Global.General.CallWrapperSync(175200,"N!*!!*!")
	F.Global.General.CallWrapperSync(50,"PUR060/N")
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt2)
	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdManualPO_Click.End

Program.Sub.cmdAutoPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	
	Gui.frmNewPO..Visible(False)
	F.Global.General.LaunchMenuTask(294,0,V.Local.iRet)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdAutoPO_Click.End

Program.Sub.PrintAudit.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare

	F.Intrinsic.Control.SelectCase(V.Global.iPrintAudit)
		F.Intrinsic.Control.Case(1)
			F.Global.General.CallWrapperSync(50,"PUR119GI")
		F.Intrinsic.Control.Case(2)
			'Do Not Print
		F.Intrinsic.Control.Case(3)
			F.Intrinsic.UI.Msgbox("Print Audit Trail?","Print",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.Global.General.CallWrapperSync(50,"PUR119GI")
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.PrintAudit.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'GvAllPOs
	Gui.FrmPO.GsGCAllPOs.Serialize("gvAllPOs",V.Local.sSerialize)
'GB   5222
'	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",4163,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
        F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",5222,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvExpToday
	Gui.FrmPO.GsGCExpToday.Serialize("gvExpToday",V.Local.sSerialize)
'GB   5222
'	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",4163,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
        F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",5222,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvPastDue
	Gui.FrmPO.GsGCPastDue.Serialize("gvPastDue",V.Local.sSerialize)
'GB   5222
'	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",4163,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
        F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",5222,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvOSV
	Gui.FrmPO.GsGCOSV.Serialize("gvOSV",V.Local.sSerialize)
'GB   5222
'	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",4163,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
        F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",5222,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvReqs
	Gui.FrmPO.GsGcReqs.Serialize("gvReqs",v.Local.sSerialize)
'GB   5222
'	F.Global.Registry.AddValue(v.Caller.User,v.Caller.CompanyCode,"GVREQS",4163,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,v.Local.sSerialize)
        F.Global.Registry.AddValue(v.Caller.User,v.Caller.CompanyCode,"GVREQS",5222,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,v.Local.sSerialize)	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'Delete old registry records
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",4163,0,5,"",V.Local.sSerialize)
        F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",5222,0,5,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
'GB   5222
'		F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 4163 And Seq < 1000;")
                F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 5222 And Seq < 1000;")
		F.ODBC.Connection!common.Close
	F.Intrinsic.Control.EndIf

	'GvAllPOs
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",4163,1000,6,"",V.Local.sSerialize)
        F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",5222,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCAllPOs.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvExpToday
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",4163,1000,6,"",V.Local.sSerialize)
        F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",5222,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCExpToday.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvPastDue
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",4163,1000,6,"",V.Local.sSerialize)
        F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",5222,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCPastDue.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvOSV
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",4163,1000,6,"",V.Local.sSerialize)
        F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",5222,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCOSV.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvReqs
'GB   5222
'	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVREQS",4163,1000,6,"",V.Local.sSerialize)
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVREQS",5222,1000,6,"",V.Local.sSerialize)
        F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGcReqs.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.Comments.Start
${$0$}$GCG_5222_PU_PurchaseReview_POConf$}$Joey T & AGV$}$5/17/2016 10:18:54 AM$}$False
Program.Sub.Comments.End